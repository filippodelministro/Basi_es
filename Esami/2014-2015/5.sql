Esercizio 1 (7 punti)
Scrivere una query che restituisca la parte del corpo maggiormente colpita da patologie con invalidità supe-
riore al 70%. In caso di pari merito, restituire tutte le parti del corpo.
Esercizio 2 (7 punti)
Scrivere una query che restiuisca il numero di terapie iniziate da ciascun paziente in ogni mese dell’anno.
Nel risultato devono comparire tutti i pazienti e tutti i mesi dell’anno.
Esercizio 3 (9 punti)
Scrivere una query che restituisca, relativamente al mese di Giugno 2011, la percentuale d’incasso totale
mensile dovuta alle visite nefrologiche. Non si usino view, né derived table.
Esercizio 4 (10 punti)
Scrivere una stored procedure per l’inserimento di una nuova terapia. Nel caso in cui il paziente oggetto
della terapia non abbia assunto in precedenza lo stesso principio attivo, la terapia non deve essere inserita e
deve essere restituito un messaggio di errore del tipo: “Il paziente potrebbe essere allergico al principio at-
tivo X”. Sostituire X con il nome del principio attivo oggetto della terapia. La stored procedure non deve
contenere istruzioni di tipo CREATE.